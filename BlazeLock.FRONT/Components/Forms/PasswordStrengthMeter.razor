<div class="mt-2 w-full">
    <div class="h-1.5 w-full bg-gray-200 rounded-full overflow-hidden">
        <div class="h-full transition-all duration-300 ease-out @_color"
             style="width: @_percent%">
        </div>
    </div>

    <div class="flex justify-end mt-1">
        <span class="text-xs font-semibold @_textColor transition-colors duration-300">
            @_label
        </span>
    </div>
</div>

@code {
    [Parameter] public string Password { get; set; } = "";

    private string _color = "bg-gray-200";
    private string _textColor = "text-gray-400";
    private string _label = "";
    private int _percent = 0;

    protected override void OnParametersSet()
    {
        CalculateStrength();
    }

    private void CalculateStrength()
    {
        if (string.IsNullOrEmpty(Password))
        {
            _percent = 0; _label = ""; _color = "bg-gray-200"; return;
        }

        int score = 0;
        if (Password.Length >= 8) score++;
        if (Password.Length >= 12) score++;
        if (Password.Any(char.IsDigit)) score++;
        if (Password.Any(char.IsUpper)) score++;
        if (Password.Any(ch => !char.IsLetterOrDigit(ch))) score++;

        switch (score)
        {
            case 0:
            case 1:
                _percent = 20;
                _color = "bg-red-500";
                _textColor = "text-red-500";
                _label = "Faible";
                break;
            case 2:
                _percent = 40;
                _color = "bg-orange-500";
                _textColor = "text-orange-500";
                _label = "Moyen";
                break;
            case 3:
                _percent = 60;
                _color = "bg-yellow-500";
                _textColor = "text-yellow-600";
                _label = "Bon";
                break;
            case 4:
                _percent = 80;
                _color = "bg-green-500";
                _textColor = "text-green-600";
                _label = "Fort";
                break;
            case 5:
                _percent = 100;
                _color = "bg-emerald-600";
                _textColor = "text-emerald-700";
                _label = "Excellent";
                break;
        }
    }
}